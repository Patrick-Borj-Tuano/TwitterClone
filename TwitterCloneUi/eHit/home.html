<!DOCTYPE html>
<html lang="en">

<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="homePage_api.js"></script>
</head>

<body>

    <div id="sidebar">
        <div id="profile-container">
            <div id="profile-picture-container">
                <img id="profile-pic" src="/Login-Signup/Images/twitter-logo.png" alt="Profile Picture">
            </div>
            <div id="username-container">
                <a id="username-display" href="profile.html"> Your Username </a>
            </div>
            <div id="sign-out-container">    
                <button id="sign-out-button" onclick="logOut()">Sign Out</button>
            </div>
        </div>
      
        <div id="users-container">
            <!-- <h2>Users List</h2> -->
            
            <!-- Potential User API Here -->

            <div class="search-container">
                <input type="text" class="searchBox" id="search-user-1" placeholder="Enter username" oninput="toggleSearchButton()">
                <button id="clearButton" style="display: none;" onclick="clearText()">x</button>
            </div>

            <!-- <div class="user-follow">
                <label id="Label2">User 2 </label>
                <button class="followButton" id="user-follow-2" onclick="toggleFollow(this)" onmouseover="hoverButton(this)" onmouseout="unhoverButton(this)">Follow</button>
            </div>
            <div class="user-follow">
                <label id="Label3">User 3 </label>
                <button class="followButton" id="user-follow-3" onclick="toggleFollow(this)" onmouseover="hoverButton(this)" onmouseout="unhoverButton(this)">Follow</button>
            </div> -->

        </div>
    
        <div id="trending-container">
            <h2>Trending</h2>
            <!-- Potential Hashtags API Here -->
            <ul>
                <li>#Hashtag1</li>
                <li>#Hashtag2</li>
                <li>#Hashtag3</li>
            </ul>
        </div>
    </div>

    <div id="desktop-nav">
        <div>
            <ul id="desktop-header">
                <li><a href="/account/login.html">Your Post</a></li>
                <li><a href="/eHit/home.html"><img class="website-logo" src="/Login-Signup/Images/twitter-logo.png" alt="website-logo"></a></li>
                <li><a href="#following">Following</a></li>
            </ul>
        </div>
        <main>
            <form id="postForm">
                <textarea id="postContent" placeholder="What is happening?!" maxlength="280" required></textarea>
                <button type="submit" class="postBtn">Submit Post</button>
            </form>
    
            <!-- container for posts -->
            <div id="postsContainer">
                <!-- <p class="placeholder-text">FOLLOW USERS TO SEE WHAT THEY ARE POSTING</p> -->

                <!-- Structure of Post When Created-->
                <!-- <div class="post">
                    <div class="post-head">
                        <img class="profile-picture" src = 'sample_profile_picture.jpg'>
                        <span>USERNAME</span>  
                        <span>Time</span>                     
                    </div>
                    <p>
                            Hello
                    </p>
                    <button class="likeBtn" >

                    </button>
                    <span class="likeCount"></span>
                </div> -->

            </div>
        </main>
    </div>
    
    <script>
        // Retrieve the username from localStorage
        var username = localStorage.getItem('username');
        document.addEventListener('DOMContentLoaded', function () {

        // Display the username in the username container
        const usernameDisplay = document.getElementById('username-display');
        usernameDisplay.textContent = username;
        displayUserPosts();
        });

        


        function toggleSearchButton() {
        var inputText = document.getElementById('search-user-1').value;
        var button = document.getElementById('clearButton');

        if (inputText.trim() !== '') {
            button.style.display = 'inline-block';
        } else {
            button.style.display = 'none';
        }
    }

        function clearText() {
            var inputElement = document.getElementById('search-user-1');
            inputElement.value = '';
            toggleSearchButton();
        }

        // function toggleFollow(button) {
        //     if (button.innerHTML === "Follow") {
        //         button.innerHTML = "Following";
        //         button.classList.remove("followButton");
        //         button.classList.add("unfollowButton");
        //     } else {
        //         button.innerHTML = "Follow";
        //         button.classList.remove("unfollowButton");
        //         button.classList.add("followButton");
        //     }
        // }

        // function hoverButton(button) {
        //     if (button.innerHTML === "Following") {
        //         button.classList.add("following");
        //         button.innerHTML = "Unfollow";
        //     }
        // }

        // function unhoverButton(button) {
        //     if (button.innerHTML === "Unfollow") {
        //         button.classList.remove("following");
        //         button.innerHTML = "Following";
        //     }
        // }


         //posting logic
            document.getElementById('postForm').addEventListener('submit', function(event) {
            event.preventDefault(); //prevents the default submission behavior

            userPost();

            var content = document.getElementById('postContent').value;            
            var postDiv = document.createElement('div');
            postDiv.className = 'post';

            var postHead = document.createElement('div')
            postHead.className = 'post-head'

            var postUser = document.createElement('span')
            postUser.className = "post-head-user"
            postUser.textContent = username;


            var postTime = document.createElement('span')
            postTime.className = "post-head-user"

            
            var profilePicture = document.createElement('img');
            profilePicture.className = 'profile-picture';
            profilePicture.src = 'sample_profile_picture.jpg'; //change to pfp set by the userr

           
            postHead.appendChild(profilePicture);
            postHead.appendChild(postUser);
            postHead.appendChild(postTime);



            var postContent = document.createElement('p');
            postContent.textContent = content;
            var likeButton = document.createElement('button');
            likeButton.className = 'likeBtn';
            likeButton.textContent = 'Like';
            var likeCount = document.createElement('span');
            likeCount.className = 'likeCount'; 
            likeCount.textContent = '0';

            postDiv.appendChild(postHead);
            postDiv.appendChild(postContent);
            postDiv.appendChild(likeButton);
            postDiv.appendChild(likeCount); 

            
            var postsContainer = document.getElementById('postsContainer');
            var placeholderText = postsContainer.querySelector('.placeholder-text');
            if (placeholderText) {
                
                postsContainer.removeChild(placeholderText);
            }
            
            postsContainer.insertBefore(postDiv, postsContainer.firstChild);

            
            document.getElementById('postContent').value = '';
           
            likeButton.addEventListener('click', function() {
                if (likeButton.textContent === 'Like') {
                    var currentLikes = parseInt(likeCount.textContent);
                    likeCount.textContent = currentLikes + 1;
                    likeButton.textContent = 'Unlike';
                } else {
                    var currentLikes = parseInt(likeCount.textContent);
                    likeCount.textContent = currentLikes - 1;
                    likeButton.textContent = 'Like';
                }
            });
        });

    </script>



</body>
</html>